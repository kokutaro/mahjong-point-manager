# 風露牌の表示設計

## 目的

- 役ヘルプ等で、手牌とは別に風露（チー/ポン/カン）を視覚的に表示できるようにする。
- 文字列表記（牌姿短縮表記）に基づいて、鳴いた牌の向き・位置を反映する。

## 表記ルール（入力）

- ベースは既存の短縮表記（例: `s123m222s44_,z111-,z2222`）。
- 鳴き方向記号は末尾に付与（`-`=下家、`=`=対面、`+`=上家）。
- チーの3桁は並び順任意。ただし並べ替えると順子になること。方向記号直前の数字を「鳴いた牌」とする。
  - 例) m34 を持っていて m2 をチー: `m342-`（`2` が鳴いた牌）

## 表示ルール（UI）

- チー: 常に左端の牌を横向きにする。上記の「鳴いた牌」を左端に配置し、回転表示。
- ポン: 下家=左、対面=中央、上家=右 の牌を横向きにする。
- 明槓: 下家=左、対面=左から2番目、上家=右 の牌を横向きにする。
- 暗槓: 両端は裏（`blank.gif`）表示、中央2つは表向き。
- 加槓: ポンと同じ位置の牌を横向きにし、その上に横向きの1枚を重ねる（重ね位置固定）。

## 実装概要

- 解析: `parseHandNotation` を拡張し、チーで「鳴いた牌」を `called` として保持。3桁は任意順で受け入れつつ内部は昇順に正規化。
- 表示: `MeldTiles` コンポーネントを新規追加し、上記規則に従って `Tile` を配置。
  - `Tile` に `rotate`/`back` を追加し、回転/裏面（`/img/pai/blank.gif`）をサポート。
- 役ヘルプ: `YakuRow` で `examples[0]` が `notation` を持つ場合は、手牌と風露を分離表示。なければ従来の `tiles` 表示を維持。

## テスト

- 単体: `hand-notation` のチー拡張（`m342-` 受理と `called` 付与）、`MeldTiles` の回転/裏/重ねの描画確認。
- E2E: 役ヘルプ/デモページで風露付き入力の視認確認（Playwright）。

## 移行/互換性

- 既存の `tiles` 例はそのまま表示可能。`notation` を追加した例は風露表示に切り替わる。
- `formatHandNotation` は正規化表記（昇順の `123-`）を維持（出力仕様の互換）。
